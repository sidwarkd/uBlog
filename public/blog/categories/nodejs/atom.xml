<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: NodeJS | The &micro;Blog
]]></title>
  <link href="http://blog.microcasts.tv/blog/categories/nodejs/atom.xml" rel="self"/>
  <link href="http://blog.microcasts.tv/"/>
  <updated>2014-10-16T22:08:22-06:00</updated>
  <id>http://blog.microcasts.tv/</id>
  <author>
    <name><![CDATA[K-SID]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Edison Mini Breakout: The Real Getting Started Guide]]></title>
    <link href="http://blog.microcasts.tv/2014/10/16/edison-mini-breakout-the-real-getting-started-guide/"/>
    <updated>2014-10-16T13:45:00-06:00</updated>
    <id>http://blog.microcasts.tv/2014/10/16/edison-mini-breakout-the-real-getting-started-guide</id>
    <content type="html"><![CDATA[<h1 style="text-align:center;"><img src="/images/edison/wide_edison_breakout.jpg"></h1>


<p>So I sat down the other night to finally start playing with my <a href="http://www.intel.com/content/www/us/en/do-it-yourself/edison.html">Intel Edison</a> board and quickly found out that the documentation for this thing really sucks. There are forums and pages and PDFs spread all over the Intel site and most of the content centers around using the Arduino breakout board. For those of us using the <a href="https://www.sparkfun.com/products/13025">mini breakout board</a> we are left to our own resourcefulness to get this thing up and running. There is even incorrect info in the <a href="https://communities.intel.com/docs/DOC-23147">Quickstart</a> that might leave beginners scratching their heads. If Intel wants this thing to get widespread community adoption it needs to spend significantly more time making the first experience a better one.</p>

<p>Until then, here is my version of how to get started with the Edison mini breakout board. This is the guide I wish I had for my first experience.</p>

<!-- more -->


<h2>Unboxing and Setup</h2>

<p>So Intel nailed the unboxing part. The Edison comes in a sweet box and opening it evokes a few oooohs and aaahs. That&rsquo;s about where it ends though. They have a getting started url right under the box lid which makes you think that they are really going to help you through the process but unfortunately you&rsquo;re mostly on your own at this point. The link has only partially relevant instructions to the mini breakout and even some of the relevant stuff has errors.</p>

<p><strong>STOP:</strong> Installing a header is completely optional but if you intend to connect your Edison to external hardware at some point I recommend you solder one on now. You can always do it later but the tiny 70 pin Hirose connector makes me nervous so I&rsquo;d rather not stress it with unnecessary insertions and removals.</p>

<h3>Install a Header (Optional)</h3>

<p>If you intend to connect any external hardware to your Edison you&rsquo;re going to need access to the GPIO pins. These are located under the Edison itself on the breakout board.</p>

<p>You can individually solder wires to this but I personally recommend breaking all of the pins out to a header for easy connection. This is really easy to do even for a beginner so don&rsquo;t be afraid. The pins are standard 0.1" spaced so any <a href="https://www.sparkfun.com/products/116">generic male header strip</a> will do. Break the header strip into 14 pin segments and install them side by side on a breadboard as seen below. Make sure the long end of the header strip pins is in the breadboard so the short side is pointing up.</p>

<h1 style="text-align:center;"><img src="/images/edison/header_guide.jpg"></h1>


<p>This will be your jig for soldering. Place the breakout board onto the pins so that the USB connectors are on top. Solding the headers in upside down will definitely ruin your day. The breakout should sit on the pins and feel nice and level. If installed correctly the header pins will just barely protrude from the holes. This ensures that they won&rsquo;t interfere with seating the Edison later on. If the pins stick out too far then you&rsquo;ve got your header installed upside down on the breadboard.</p>

<h1 style="text-align:center;"><img src="/images/edison/header_pre_solder.jpg"></h1>


<p>For soldering I highly recommend using a <a href="http://www.alliedelec.com/search/productdetail.aspx?SKU=70177953">flux pen</a>. It will help the solder flow into the joints. Take your time soldering and make sure you get a good solder flow on each joint and be careful not to over-apply solder as it will ball up on the pin and not create a good joint. Here is what mine looked like when I was done. You can see that there are a few joints that aren&rsquo;t as nice as the others but we should be okay. I used some rubbing alcohol and a clean t-shirt rag to clean the flux up after soldering.</p>

<h1 style="text-align:center;"><img src="/images/edison/header_post_solder.jpg"></h1>


<h3>Insert the Edison</h3>

<p>Because of the mounting holes it&rsquo;s pretty much impossible to install the Edison the wrong way on the breakout board. Just be careful seating it as the 70 pin connector has very tiny contacts that can be damaged if you&rsquo;re not careful. Get the Edison nice and level over the connector and push straight down on it right about where the sticker is below the metal housing. You should hear a good sounding click.</p>

<h1 style="text-align:center;"><img src="/images/edison/push_here.jpg"></h1>


<p>Install the two nuts provided to hold the Edison in place.</p>

<h2>Install Software and Drivers</h2>

<p>The Quickstart guide provided by Intel has you install the Arduino IDE next. Now even though this isn&rsquo;t the Arduino breakout you can still write sketches and run them. You just have to break out the appropriate pins yourself. I&rsquo;m not interested in Arduino functionality so I opted to skip that part but if you want you can <a href="https://communities.intel.com/docs/DOC-23242">install that now</a>.</p>

<p>The <a href="https://communities.intel.com/docs/DOC-23147#jive_content_id_Step_3__Install_required_drivers">driver installation step</a> from the Quickstart is one of the few items they nailed in the guide and you can follow the instructions <a href="https://communities.intel.com/docs/DOC-23147#jive_content_id_Step_3__Install_required_drivers">there</a>. Basically you&rsquo;re downloading and installing two sets of drivers: one for the FTDI interface and one for the Edison itself. Here are the links for both. Just click through the installations.</p>

<h3>FTDI Drivers</h3>

<ul>
<li><a href="http://www.ftdichip.com/Drivers/CDM/CDM%20v2.10.00%20WHQL%20Certified.exe">FTDI Driver Setup</a></li>
</ul>


<h3>Edison Drivers</h3>

<ul>
<li><a href="http://downloadmirror.intel.com/24271/eng/IntelEdisonDriverSetup1.0.0.exe">Edison Windows Driver Setup</a></li>
</ul>


<h3>Terminal Emulator</h3>

<ul>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">PuTTY</a></li>
</ul>


<p>For your computer to talk to the Edison at first you will need to use a serial connection. This is acheived over USB with the FTDI drivers which essentially speak USB to the FTDI chip on your breakout board and then the FTDI chip translates USB to serial for the Edison to understand. A terminal emulator is the program that runs on your PC that manages that connection. The most popular one is <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">PuTTY</a> but you can use any terminal emulator you feel comfortable with.</p>

<h2>Powering Your Edison</h2>

<p>This one stumped me a little at first. There are two USB ports on the mini breakout and I assumed one was for power and communication and the other was for connecting devices to the Edison so it could act as a USB host. You probably didn&rsquo;t assume that but if you did you would be wrong&hellip;just like me. One of the USB ports is for communicating with your PC via the terminal emulator and the other is one of the ways you can power the Edison. As found in <a href="https://communities.intel.com/thread/55455">this thread</a> there are actually 3 different ways to power your Edison via the breakout board.</p>

<ul>
<li>5V via the USB connector</li>
<li>7-12V via J21</li>
<li>Single Cell LiPo battery via J2</li>
</ul>


<h1 style="text-align:center;"><img src="/images/edison/power_options.jpg"></h1>


<h2>Configuring Your Edison</h2>

<p>Once you&rsquo;ve decided on a power strategy for your Edison it&rsquo;s time to power it up and play with it. By default your Edison comes with <a href="https://www.yoctoproject.org/">Yocto Linux</a> installed but you&rsquo;ll need to configure it.</p>

<ol>
<li> Connect the Edison to your PC with the USB cable.</li>
<li> Apply power. The easiest way to do this is via the second USB port. I didn&rsquo;t have a free port on my PC so I used a USB battery pack and it worked great.</li>
<li> Launch Device Manager (Go to Start and search &ldquo;Device Manager&rdquo; if you can&rsquo;t find it)</li>
<li> In Device Manager expand the <strong>Ports</strong> section and find the entry named <em>USB Serial Port (COM&hellip;)</em>. In parenthesis is the COM port your Edison can talk on. On my machine it&rsquo;s COM4.
<img src="/images/edison/com_port.jpg"></li>
<li> Launch your terminal emulator. These instructions assume you&rsquo;re using PuTTY.</li>
<li> Set the following options for communication

<ul>
<li>Connection Type: <strong>Serial</strong></li>
<li>Serial Line: <strong>[The COM value you found in step 4]</strong></li>
<li>Speed: <strong>115200</strong></li>
</ul>


<p><img src="/images/edison/putty_config.jpg"></p></li>
<li> Click <strong>Open</strong>

<ul>
<li><strong>NOTE: You are now about to start experiencing a super annoying defect in the Edison UART. This is what the datasheet says:</strong></li>
</ul>


<p><em>When Edison goes into low power sleep, the UART internal FIFO and interface is powered down. Therefore, a two-wire UART (Rx/Tx) will lose the first received character whenever Edison is in sleep mode.</em></p>

<p><strong>Basically if you don&rsquo;t type anything for about 20 seconds or so the next time you press a key in the terminal it will wake up the Edison but not register your key. You&rsquo;ll have to hit it again. It&rsquo;s very annoying and I will post info on how to disable sleep mode as soon as I figure it out</strong></p></li>
<li> Wait for the blank terminal window to appear.</li>
<li> Hit <strong>Enter</strong> twice. You may have to hit it 3 times if you waited too long. Told you it was annoying.</li>
<li> At the login prompt type <strong>root</strong></li>
<li> At the next prompt type <strong>configure_edison</strong></li>
</ol>


<p>Follow the prompts through the configuration. If the Edison doesn&rsquo;t locate any WiFi networks at first just press <strong>0</strong> to have it rescan. Mine didn&rsquo;t find any the first time around for some reason.</p>

<h2>Start Poking Around</h2>

<p>Once you&rsquo;ve finished configuring your Edison you can essentially treat it like a Linux machine. I was surprised to find that it had NodeJS and NPM installed and was able to get an Express website up and running within a couple of minutes.</p>

<p>A few things of note:</p>

<ul>
<li>If you want to create/edit files the Edison comes with Vim which can be launched with <strong>vi</strong></li>
<li>To shut down the Edison use <strong>systemctl poweroff</strong></li>
<li>If you&rsquo;re coming from Raspberry Pi land most of the Linux commands you already know still apply</li>
</ul>


<p>If you have any problems or questions feel free to <a href="https://twitter.com/kevinsidwar">reach out on Twitter</a>. I&rsquo;m always happy to help if I can.</p>

<h1 style="text-align:center;"><img src="/images/edison/finger_edison.jpg" width="611" height="400"></h1>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[µCast #17: Control Hardware Remotely With Socket.IO]]></title>
    <link href="http://blog.microcasts.tv/2014/06/21/using-socket-io-to-control-the-raspberry-pi-remotely/"/>
    <updated>2014-06-21T00:13:00-06:00</updated>
    <id>http://blog.microcasts.tv/2014/06/21/using-socket-io-to-control-the-raspberry-pi-remotely</id>
    <content type="html"><![CDATA[<p>If you&rsquo;ve been paying attention to hardware lately you&rsquo;ve probably noticed how people have gone insane over remotely accessing their devices. In this &micro;Cast I&rsquo;ll show you a simple way to get your project setup so that you can talk to it and control it via the interwebs. The best part, it only takes about 20 minutes.</p>

<br/>


<iframe width="560" height="315" src="http://blog.microcasts.tv//www.youtube.com/embed/z3O26CC9nAc" frameborder="0" allowfullscreen></iframe>


<!-- more -->


<p>We&rsquo;ll pull together all kinds of awesomeness using</p>

<ul>
<li><a href="http://socket.io/download/">SocketIO</a></li>
<li><a href="http://nodejs.org">Node</a></li>
<li><a href="http://expressjs.com">Express</a></li>
<li><a href="https://heroku.com">Heroku</a> by using the <a href="https://toolbelt.heroku.com/">Heroku Toolbelt</a></li>
<li><a href="http://jquery.com/">jQuery</a></li>
<li>and more</li>
</ul>


<p>Credit to <a href="https://twitter.com/HugoGiraudel">Hugo Giraudel</a> for the <a href="http://tympanus.net/codrops/2012/09/13/button-switches-with-checkboxes-and-css3-fanciness/">awesome CSS styled checkbox</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[µCast #16: Pi + Express + Bootstrap + Angular FTW!]]></title>
    <link href="http://blog.microcasts.tv/2014/04/14/pi_express_bootstrap_angular/"/>
    <updated>2014-04-14T23:19:00-06:00</updated>
    <id>http://blog.microcasts.tv/2014/04/14/pi_express_bootstrap_angular</id>
    <content type="html"><![CDATA[<p><strong>[UPDATE]:</strong> I&rsquo;ve had requests to post the finished code on Github for those that want to just play with the completed app. It&rsquo;s now available at <a href="https://github.com/sidwarkd/pimonitor">https://github.com/sidwarkd/pimonitor</a>.</p>

<p>About a month ago I came across the <a href="http://lifehacker.com/command-pi-monitors-your-raspberry-pi-from-your-phone-1561340630">CommandPi</a> iOS app. It looked interesting so I paid the 99 cents and downloaded it to my iPad. The problem was, it didn&rsquo;t work. I would provide my SSH credentials and after logging in the program would crash. So like any curious developer, instead of waiting for a fix I set out to write my own.</p>

<p>To be fair to the creator of <a href="https://itunes.apple.com/us/app/command-pi/id830462681?mt=8">CommandPi</a>, what you are about to see is not meant to take anything away from that app. The app creator has put together a very nice UI and the crashing issue has been fixed. I just wanted to see how easy or hard it would be to create a knock off using <a href="http://expressjs.com/">ExpressJS</a>, <a href="http://angularjs.org/">Angular</a> and <a href="http://getbootstrap.com/">Bootstrap</a>.</p>

<br/>


<iframe width="560" height="315" src="http://blog.microcasts.tv//www.youtube.com/embed/zprWNhB0NeU" frameborder="0" allowfullscreen></iframe>




<!-- more -->




<br/>


<br/>


<p>In <a href="http://blog.microcasts.tv/2014/03/15/memory-usage-on-the-raspberry-pi/">µCast #14</a> and <a href="http://blog.microcasts.tv/2014/03/20/cpu-usage-on-the-raspberry-pi/">µCast #15</a> we created the plumbing necessary to grab most of the information necessary to create our app. We also expose the <a href="http://blog.microcasts.tv/2013/10/25/query-temperature-on-raspberry-pi/">temperature reading given by the Pi</a>. This episode was shot in a single take (with light editing for time) showing how to pull various technologies together to create a web application for monitoring our Raspberry Pi.</p>

<p>This is the pinode_stats.gist used in the video.</p>

<p><div><script src='https://gist.github.com/sidwarkd/10226198.js?file=pinode_stats.js'></script>
<noscript><pre><code>'use strict'

// An example of accessing system information on the Raspberry Pi with NodeJS

var fs = require('fs');

var PiStats = function(){
  var stats = {};
  var _currentCPUInfo = {total:0, active:0};
  var _previousCPUInfo = {total:0, active:0};

  var memInfo = {};
  var currentCPUInfo = {total:0, active:0};
  var lastCPUInfo = {total:0, active:0};

  function getValFromLine(line){
    var match = line.match(/[0-9]+/gi);
    if(match !== null)
      return parseInt(match[0]);
    else
      return null;
  }

  var getMemoryInfo = function(cb){
    fs.readFile('/proc/meminfo', 'utf8', function(err, data){
      if(err){
        if(cb !== undefined)
          cb(err);
        return;
      }
      var lines = data.split('\n');
      stats.memTotal = Math.floor(getValFromLine(lines[0]) / 1024);
      stats.memFree = Math.floor(getValFromLine(lines[1]) / 1024);
      stats.memCached = Math.floor(getValFromLine(lines[3]) / 1024);
      stats.memUsed = stats.memTotal - stats.memFree;
      stats.memPercentUsed = Math.ceil(((stats.memUsed - stats.memCached) / stats.memTotal) * 100);

      if(cb !== undefined)
        cb(null, stats);
    });
  };

  var calculateCPUPercentage = function(oldVals, newVals){
    var totalDiff = newVals.total - oldVals.total;
    var activeDiff = newVals.active - oldVals.active;
    return Math.ceil((activeDiff / totalDiff) * 100);
  };

  var getCPUInfo = function(cb){
    _previousCPUInfo.active = _currentCPUInfo.active;
    _previousCPUInfo.idle = _currentCPUInfo.idle;
    _previousCPUInfo.total = _currentCPUInfo.total;

    fs.readFile('/proc/stat', 'utf8', function(err, data){
      if(err){
        if(cb !== undefined)
          cb(err);
        return;
      }
      var lines = data.split('\n');
      var cpuTimes = lines[0].match(/[0-9]+/gi);
      _currentCPUInfo.total = 0;
      // We'll count both idle and iowait as idle time
      _currentCPUInfo.idle = parseInt(cpuTimes[3]) + parseInt(cpuTimes[4]);
      for (var i = 0; i &lt; cpuTimes.length; i++){
        _currentCPUInfo.total += parseInt(cpuTimes[i]);
      }
      _currentCPUInfo.active = _currentCPUInfo.total - _currentCPUInfo.idle
      _currentCPUInfo.percentUsed = calculateCPUPercentage(_previousCPUInfo, _currentCPUInfo);

      stats.cpuUsage = _currentCPUInfo.percentUsed;

      if(cb !== undefined)
        cb(null, stats);
    });
  };

  var getCurrentTemperature = function(cb){
    // Uncomment the next 3 lines for testing on regular linux and comment
    // out the fs.readFile block
    //stats.tempC = 42.3;
    //stats.tempF = 102.5;
    //cb(null, stats);
    fs.readFile('/sys/class/thermal/thermal_zone0/temp', 'utf8', function(err, data){
      var temp = data.match(/[0-9]+/gi);
      stats.tempC = parseInt(temp[0]) / 1000;
      stats.tempF = stats.tempC * 1.80 + 32.00;

      if(cb !== undefined)
        cb(null, stats);
    });
  }

  return{
    getMemoryInfo: getMemoryInfo,
    getCPUInfo: getCPUInfo,
    update: function(cb){
      getMemoryInfo(function(err, data){
        getCPUInfo(function(err1, data1){
          getCurrentTemperature(function(err2, data2){
            cb(err2, data2);
          });
        });
      });
    },
    printMemoryInfo: function(){
      getMemoryInfo(function(err, data){
        console.log(&quot;total\tused\tfree\tcached&quot;);
        console.log( data.total + &quot;\t&quot; + data.used + &quot;\t&quot; + data.free + &quot;\t&quot; + data.cached );
        console.log(&quot;Memory Usage:\t&quot; + data.percentUsed + &quot;%&quot;);
        return;
      });
    },
    printCPUInfo: function(){
      getCPUInfo(function(err, data){
        console.log(&quot;Current CPU Usage: &quot; + data.percentUsed + &quot;%&quot;);
      });
    }
  };
}();

module.exports = PiStats;

// Example usage

// var stats = require('./pinode_stats.js');
// stats.update(function(err, data){
//   console.log(data);
// });

</code></pre></noscript></div>
</p>
]]></content>
  </entry>
  
</feed>
